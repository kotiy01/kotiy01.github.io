(function(){"use strict";var e={555:function(e,t,i){var n=i(5130),a=i(6768),o=i(4232);const l={key:0},r={key:1};function s(e,t,i,n,s,h){const c=(0,a.g2)("MenuComponent"),d=(0,a.g2)("ResizeComponent"),u=(0,a.g2)("CanvasComponent"),g=(0,a.g2)("v-footer"),m=(0,a.g2)("v-app");return(0,a.uX)(),(0,a.Wv)(m,null,{default:(0,a.k6)(()=>[(0,a.bF)(c,{"scale-percent":s.scalePercent,onImageLoaded:h.onImageLoaded,onScaleChanged:h.onScaleChanged,onOpenResize:t[0]||(t[0]=e=>s.showResize=!0)},null,8,["scale-percent","onImageLoaded","onScaleChanged"]),(0,a.bF)(d,{modelValue:s.showResize,"onUpdate:modelValue":t[1]||(t[1]=e=>s.showResize=e),width:s.imageSrc?.width,height:s.imageSrc?.height,onConfirm:h.applyResize,onOpenResize:t[2]||(t[2]=()=>{console.log("OPEN"),s.showResize=!0})},null,8,["modelValue","width","height","onConfirm"]),(0,a.bF)(u,{ref:"canvas",imageSrc:s.imageSrc,scalePercent:s.scalePercent},null,8,["imageSrc","scalePercent"]),(0,a.bF)(g,{app:"",height:"32",color:"grey-darken-3",class:"white--text px-4 d-flex align-center justify-center"},{default:(0,a.k6)(()=>[s.statusText?((0,a.uX)(),(0,a.CE)("div",l,(0,o.v_)(s.statusText),1)):((0,a.uX)(),(0,a.CE)("div",r,"Загрузите изображение"))]),_:1})]),_:1})}function h(e,t,i,n,o,l){const r=(0,a.g2)("v-toolbar-title"),s=(0,a.g2)("v-btn"),h=(0,a.g2)("v-select"),c=(0,a.g2)("v-app-bar");return(0,a.uX)(),(0,a.Wv)(c,{app:"",color:"primary"},{default:(0,a.k6)(()=>[(0,a.bF)(r,null,{default:(0,a.k6)(()=>[...t[2]||(t[2]=[(0,a.eW)("Онлайн Фотошоп",-1)])]),_:1}),(0,a.bF)(s,{onClick:l.triggerFileInput,class:"mr-4"},{default:(0,a.k6)(()=>[...t[3]||(t[3]=[(0,a.eW)(" Загрузить изображение ",-1)])]),_:1},8,["onClick"]),(0,a.bF)(s,{class:"ml-2",onClick:t[0]||(t[0]=t=>e.$emit("open-resize"))},{default:(0,a.k6)(()=>[...t[4]||(t[4]=[(0,a.eW)(" Изменить размер ",-1)])]),_:1}),(0,a.bF)(h,{items:o.scales,"model-value":o.currentScale,label:"Масштаб",density:"compact",style:{"max-width":"120px"},"onUpdate:modelValue":l.onScaleChange},null,8,["items","model-value","onUpdate:modelValue"]),(0,a.Lk)("input",{ref:"fileInput",type:"file",accept:".jpg,.jpeg,.png,.gb7",hidden:"",onChange:t[1]||(t[1]=(...e)=>l.onFileChange&&l.onFileChange(...e))},null,544)]),_:1})}i(6573),i(8100),i(7936),i(9577);var c={name:"MenuComponent",props:{scalePercent:Number},data(){return{scales:[12,25,50,75,100,150,200,300],currentScale:100}},watch:{scalePercent(e){this.currentScale=e}},methods:{triggerFileInput(){this.$refs.fileInput.click()},onScaleChange(e){this.currentScale=e,this.$emit("scale-changed",Number(e))},async onFileChange(e){const t=e.target.files[0];if(!t)return;const i=t.name.split(".").pop().toLowerCase();if(["jpg","jpeg","png"].includes(i)){const e=new FileReader;e.onload=e=>{const t=new Image;t.onload=()=>{this.$emit("image-loaded",{type:"image",src:e.target.result,width:t.width,height:t.height,depth:screen.colorDepth})},t.src=e.target.result},e.readAsDataURL(t)}else if("gb7"===i){const e=await t.arrayBuffer(),i=new DataView(e);if(71!==i.getUint8(0)||66!==i.getUint8(1)||55!==i.getUint8(2)||29!==i.getUint8(3))return void alert("Неверный формат GB7");const n=i.getUint8(5),a=i.getUint16(6,!1),o=i.getUint16(8,!1),l=new Uint8ClampedArray(a*o*4);let r=12;for(let t=0;t<a*o;t++){const e=i.getUint8(r++),a=127&e,o=(128&e)>>7,s=2*a;l[4*t]=s,l[4*t+1]=s,l[4*t+2]=s,l[4*t+3]=n&&0===o?0:255}this.$emit("image-loaded",{type:"gb7",width:a,height:o,pixels:l,depth:7})}}}},d=i(1241);const u=(0,d.A)(c,[["render",h]]);var g=u;const m={class:"canvas-container"},p={ref:"canvas"};function f(e,t,i,n,o,l){return(0,a.uX)(),(0,a.CE)("div",m,[(0,a.Lk)("canvas",p,null,512)])}var v={name:"CanvasComponent",props:{imageSrc:Object,scalePercent:Number},data(){return{originalPixels:null,originalWidth:0,originalHeight:0,scale:1}},watch:{imageSrc(e){e&&("image"===e.type?this.loadStandardImage(e.src):"gb7"===e.type&&this.loadGB7(e))},scalePercent(e){this.scale=e/100,this.redraw()}},methods:{loadStandardImage(e){const t=new Image;t.onload=()=>{this.originalWidth=t.width,this.originalHeight=t.height;const e=document.createElement("canvas");e.width=t.width,e.height=t.height;const i=e.getContext("2d");i.drawImage(t,0,0),this.originalPixels=i.getImageData(0,0,t.width,t.height).data,this.fitToScreen()},t.src=e},loadGB7({width:e,height:t,pixels:i}){this.originalWidth=e,this.originalHeight=t,this.originalPixels=i,this.fitToScreen()},fitToScreen(){const e=this.$el,t=e.clientWidth-100,i=e.clientHeight-100,n=Math.min(t/this.originalWidth,i/this.originalHeight,1);this.scale=n,this.$emit("scale-changed",Math.round(100*n)),this.redraw()},redraw(){if(!this.originalPixels)return;const e=Math.round(this.originalWidth*this.scale),t=Math.round(this.originalHeight*this.scale),i=this.$refs.canvas;i.width=e,i.height=t;const n=this.bilinear(this.originalPixels,this.originalWidth,this.originalHeight,e,t),a=i.getContext("2d");a.putImageData(new ImageData(n,e,t),0,0)},bilinear(e,t,i,n,a){const o=new Uint8ClampedArray(n*a*4);for(let l=0;l<a;l++)for(let r=0;r<n;r++){const s=(r+.5)*t/n-.5,h=(l+.5)*i/a-.5,c=Math.floor(s),d=Math.floor(h),u=Math.min(c+1,t-1),g=Math.min(d+1,i-1),m=s-c,p=h-d;for(let i=0;i<4;i++){const a=4*(d*t+c)+i,s=4*(d*t+u)+i,h=4*(g*t+c)+i,f=4*(g*t+u)+i;o[4*(l*n+r)+i]=e[a]*(1-m)*(1-p)+e[s]*m*(1-p)+e[h]*(1-m)*p+e[f]*m*p}}return o},nearest(e,t,i,n,a){const o=new Uint8ClampedArray(n*a*4);for(let l=0;l<a;l++)for(let r=0;r<n;r++){const s=Math.floor(r*t/n),h=Math.floor(l*i/a),c=4*(h*t+s),d=4*(l*n+r);o.set(e.slice(c,c+4),d)}return o},resizeImage(e,t,i){const n="nearest"===i?this.nearest:this.bilinear,a=n(this.originalPixels,this.originalWidth,this.originalHeight,e,t);this.originalPixels=a,this.originalWidth=e,this.originalHeight=t,this.scale=1,this.redraw()}}};const b=(0,d.A)(v,[["render",f],["__scopeId","data-v-2cd0fcaa"]]);var w=b;const k={class:"mb-3"};function C(e,t,i,n,l,r){const s=(0,a.g2)("v-card-title"),h=(0,a.g2)("v-select"),c=(0,a.g2)("v-text-field"),d=(0,a.g2)("v-checkbox"),u=(0,a.g2)("v-tooltip"),g=(0,a.g2)("v-card-text"),m=(0,a.g2)("v-spacer"),p=(0,a.g2)("v-btn"),f=(0,a.g2)("v-card-actions"),v=(0,a.g2)("v-card"),b=(0,a.g2)("v-dialog");return(0,a.uX)(),(0,a.Wv)(b,{modelValue:r.open,"onUpdate:modelValue":t[5]||(t[5]=e=>r.open=e),"max-width":"520"},{default:(0,a.k6)(()=>[(0,a.bF)(v,null,{default:(0,a.k6)(()=>[(0,a.bF)(s,null,{default:(0,a.k6)(()=>[...t[6]||(t[6]=[(0,a.eW)("Изменение размера изображения",-1)])]),_:1}),(0,a.bF)(g,null,{default:(0,a.k6)(()=>[(0,a.Lk)("div",k,[(0,a.Lk)("div",null,"До: "+(0,o.v_)(r.mpBefore)+" Мп",1),(0,a.Lk)("div",null,"После: "+(0,o.v_)(r.mpAfter)+" Мп",1)]),(0,a.bF)(h,{items:["Проценты","Пиксели"],modelValue:l.mode,"onUpdate:modelValue":t[0]||(t[0]=e=>l.mode=e),label:"Режим изменения",density:"compact"},null,8,["modelValue"]),(0,a.bF)(c,{modelValue:l.widthValue,"onUpdate:modelValue":t[1]||(t[1]=e=>l.widthValue=e),modelModifiers:{number:!0},label:"Ширина",type:"number",density:"compact"},null,8,["modelValue"]),(0,a.bF)(c,{modelValue:l.heightValue,"onUpdate:modelValue":t[2]||(t[2]=e=>l.heightValue=e),modelModifiers:{number:!0},label:"Высота",type:"number",density:"compact"},null,8,["modelValue"]),(0,a.bF)(d,{modelValue:l.keepRatio,"onUpdate:modelValue":t[3]||(t[3]=e=>l.keepRatio=e),label:"Сохранять пропорции",color:"black",style:{color:"black"},"hide-details":""},null,8,["modelValue"]),(0,a.bF)(h,{items:l.interpolations,"item-title":"label","item-value":"value",modelValue:l.interpolation,"onUpdate:modelValue":t[4]||(t[4]=e=>l.interpolation=e),label:"Интерполяция",density:"compact"},{"append-inner":(0,a.k6)(()=>[(0,a.bF)(u,{activator:"parent",location:"end"},{default:(0,a.k6)(()=>[(0,a.eW)((0,o.v_)(r.interpolationHint),1)]),_:1})]),_:1},8,["items","modelValue"])]),_:1}),(0,a.bF)(f,null,{default:(0,a.k6)(()=>[(0,a.bF)(m),(0,a.bF)(p,{variant:"text",onClick:r.close},{default:(0,a.k6)(()=>[...t[7]||(t[7]=[(0,a.eW)("Отмена",-1)])]),_:1},8,["onClick"]),(0,a.bF)(p,{color:"primary",onClick:r.confirm},{default:(0,a.k6)(()=>[...t[8]||(t[8]=[(0,a.eW)("Применить",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}i(8111),i(116);var y={name:"ResizeComponent",props:{modelValue:Boolean,width:Number,height:Number},emits:["update:modelValue","confirm"],data(){return{mode:"Проценты",widthValue:100,heightValue:100,keepRatio:!0,interpolation:"bilinear",interpolations:[{label:"Билинейная",value:"bilinear",hint:"Плавное масштабирование, лучшее качество"},{label:"Ближайший сосед",value:"nearest",hint:"Быстро, но возможна пикселизация"}]}},computed:{open:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},mpBefore(){return(this.width*this.height/1e6).toFixed(2)},mpAfter(){const e=this.newWidth,t=this.newHeight;return(e*t/1e6).toFixed(2)},newWidth(){return"Проценты"===this.mode?Math.round(this.width*this.widthValue/100):this.widthValue},newHeight(){return"Проценты"===this.mode?Math.round(this.height*this.heightValue/100):this.heightValue},interpolationHint(){return this.interpolations.find(e=>e.value===this.interpolation)?.hint}},watch:{widthValue(e){this.keepRatio&&(this.heightValue=Math.round(e*this.height/this.width))}},methods:{close(){this.open=!1},confirm(){this.$emit("confirm",{width:this.newWidth,height:this.newHeight,interpolation:this.interpolation}),this.close()}}};const V=(0,d.A)(y,[["render",C]]);var x=V,F={name:"App",components:{MenuComponent:g,CanvasComponent:w,ResizeComponent:x},data(){return{imageSrc:null,scalePercent:100,statusText:"",showResize:!1}},methods:{onImageLoaded(e){this.imageSrc=e,this.scalePercent=100;const{width:t,height:i,depth:n}=e;this.statusText=`Размер: ${t}×${i} px | Глубина цвета: ${n} бит`},onScaleChanged(e){this.scalePercent=e},applyResize({width:e,height:t,interpolation:i}){this.$refs.canvas.resizeImage(e,t,i)}}};const S=(0,d.A)(F,[["render",s]]);var _=S,P=(i(5524),i(5753)),W=i(1839),M=i(3425);const U=(0,P.$N)({components:W,directives:M});(0,n.Ef)(_).use(U).mount("#app")}},t={};function i(n){var a=t[n];if(void 0!==a)return a.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,i),o.exports}i.m=e,function(){var e=[];i.O=function(t,n,a,o){if(!n){var l=1/0;for(c=0;c<e.length;c++){n=e[c][0],a=e[c][1],o=e[c][2];for(var r=!0,s=0;s<n.length;s++)(!1&o||l>=o)&&Object.keys(i.O).every(function(e){return i.O[e](n[s])})?n.splice(s--,1):(r=!1,o<l&&(l=o));if(r){e.splice(c--,1);var h=a();void 0!==h&&(t=h)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[n,a,o]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};i.O.j=function(t){return 0===e[t]};var t=function(t,n){var a,o,l=n[0],r=n[1],s=n[2],h=0;if(l.some(function(t){return 0!==e[t]})){for(a in r)i.o(r,a)&&(i.m[a]=r[a]);if(s)var c=s(i)}for(t&&t(n);h<l.length;h++)o=l[h],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return i.O(c)},n=self["webpackChunkphotoshop"]=self["webpackChunkphotoshop"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=i.O(void 0,[504],function(){return i(555)});n=i.O(n)})();
//# sourceMappingURL=app.1a770006.js.map